'Definitions of the Queries of the PlaySafeMetrics.accdb database.

' Created by JJ-Carron with DTT_DB_Utilities
' 04.09.2022

' File structure:
' name = definition;   

' line beginning with ' are ignored      
' the name is the last word before the =
' The definition include all the word between the the = and the ;

' Warning 
' - Only ASCII Character are supported
' - Doesn't support spaces in the query names supported

crw_BO_Total_Bans = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_Bans = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_Bans_for_100K_Entries = 
TRANSFORM Int(First(IIf([Val_LB_2_1]<>0,[Val_LB_4_2]/[Val_LB_2_1]*100000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_4_2, B.Val AS Val_LB_2_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.1') AS B ON (A.Year = B.Year) AND (A.Casino_fk = B.Casino_fk)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_Bans_for_100K_Players = 
TRANSFORM Int(First(IIf([Val_LB_2_2]<>0,[Val_LB_4_2]/[Val_LB_2_2]*100000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_4_2, B.Val AS Val_LB_2_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.2') AS B ON (A.Year = B.Year) AND (A.Casino_fk = B.Casino_fk)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_Bans_for_10Mio_GGR = 
TRANSFORM Int(First(IIf([Val_LB_99_1]<>0,[Val_LB_4_2]/[Val_LB_99_1]*10000000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_4_2, B.Val AS Val_LB_99_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_99.1') AS B ON (A.Year = B.Year) AND (A.Casino_fk = B.Casino_fk)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_EarlyDetectionProcesses = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_EarlyDetectionProcesses_Bans_Ratio = 
TRANSFORM Int(First(IIf([Val_LB_4_2]<>0,[Val_LB_3_1]/[Val_LB_4_2]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_3_1, B.Val AS Val_LB_4_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_EarlyDetectionProcesses_for_100K_Entries = 
TRANSFORM Int(First(IIf([Val_LB_2_1]<>0,[Val_LB_3_1]/[Val_LB_2_1]*100000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_3_1, B.Val AS Val_LB_2_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.1') AS B ON (A.Year = B.Year) AND (A.Casino_fk = B.Casino_fk)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_EarlyDetectionProcesses_for_100K_Players = 
TRANSFORM Int(First(IIf([Val_LB_2_2]<>0,[Val_LB_3_1]/[Val_LB_2_2]*100000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_3_1, B.Val AS Val_LB_2_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.2') AS B ON (A.Year = B.Year) AND (A.Casino_fk = B.Casino_fk)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_EarlyDetectionProcesses_for_10Mio_GGR = 
TRANSFORM Int(First(IIf([Val_LB_99_1]<>0,[Val_LB_3_1]/[Val_LB_99_1]*10000000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_3_1, B.Val AS Val_LB_99_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_99.1') AS B ON (A.Year = B.Year) AND (A.Casino_fk = B.Casino_fk)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_ED_ClosedWithoutMeasure_ED_Ratio = 
TRANSFORM Int(First(IIf([Val_LB_3_1]<>0,[Val_LB_3_3_3]/[Val_LB_3_1]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_3_3_3, B.Val AS Val_LB_3_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.3.3') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.1') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_Entries = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_ForcedBans_Bans_Ratio = 
TRANSFORM Int(First(IIf([Val_LB_4_2]<>0,[Val_LB_3_3_3]/[Val_LB_4_2]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_3_3_3, B.Val AS Val_LB_4_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_3.3.3') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_GGR = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_99.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_NoInterventionBans_Bans_Ratio = 
TRANSFORM Int(First(IIf([Val_LB_4_2]<>0,[Val_LB_4_2_3_1]/[Val_LB_4_2]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_LB_4_2_3_1, B.Val AS Val_LB_4_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2.3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_4.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_LB_Players = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.2' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_RevokedBans = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference IN ('LB_5.2.1', 'LB_6.2.1' ) GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_LB_UnauthorisedPlayer_Entries = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'LB_2.5' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_Accounts = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_2.1.2' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_ActivePlayers = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_98.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_Bans = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_Bans_for_10K_Accounts = 
TRANSFORM Int(First(IIf([Val_OL_2_1_2]<>0,[Val_OL_4_2]/[Val_OL_2_1_2]*10000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_4_2, B.Val AS Val_OL_2_1_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_2.1.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_Bans_for_10K_ActivePlayers = 
TRANSFORM Int(First(IIf([Val_OL_98_1]<>0,[Val_OL_4_2]/[Val_OL_98_1]*10000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_4_2, B.Val AS Val_OL_98_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_98.1') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_Bans_for_10Mio_GGR = 
TRANSFORM Int(First(IIf([Val_OL_99_1]<>0,[Val_OL_4_2]/[Val_OL_99_1]*10000000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_4_2, B.Val AS Val_OL_99_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_99.1') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_EarlyDetectionProcesses = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_EarlyDetectionProcesses_Bans_Ratio = 
TRANSFORM Int(First(IIf([Val_OL_4_2]<>0,[Val_OL_3_1]/[Val_OL_4_2]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_3_1, B.Val AS Val_OL_4_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_EarlyDetectionProcesses_for_10K_Accounts = 
TRANSFORM Int(First(IIf([Val_OL_2_1_2]<>0,[Val_OL_3_1]/[Val_OL_2_1_2]*10000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_3_1, B.Val AS Val_OL_2_1_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_2.1.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_EarlyDetectionProcesses_for_10K_ActivePlayers = 
TRANSFORM Int(First(IIf([Val_OL_98_1]<>0,[Val_OL_3_1]/[Val_OL_98_1]*10000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_3_1, B.Val AS Val_OL_98_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_98.1') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_EarlyDetectionProcesses_for_10Mio_GGR = 
TRANSFORM Int(First(IIf([Val_OL_99_1]<>0,[Val_OL_3_1]/[Val_OL_99_1]*10000000,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_3_1, B.Val AS Val_OL_99_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_99.1') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_ED_ClosedWithoutMeasure_ED_Ratio = 
TRANSFORM Int(First(IIf([Val_OL_3_1]<>0,[Val_OL_3_3_3]/[Val_OL_3_1]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_3_3_3, B.Val AS Val_OL_3_1 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.3.3') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.1') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_ForcedBans_Bans_Ratio = 
TRANSFORM Int(First(IIf([Val_OL_4_2]<>0,[Val_OL_3_3_3]/[Val_OL_4_2]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_3_3_3, B.Val AS Val_OL_4_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_3.3.3') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_GGR = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_99.1' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_NoInterventionBans_Bans_Ratio = 
TRANSFORM Int(First(IIf([Val_OL_4_2]<>0,[Val_OL_4_2_3_1]/[Val_OL_4_2]*100,0))) AS Ratio SELECT Casinos.Name FROM (SELECT A.Casino_fk, A.Year, A.Val AS Val_OL_4_2_3_1, B.Val AS Val_OL_4_2 FROM (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2.3.1') AS A INNER JOIN (SELECT CriterionValues.Casino_fk, CriterionValues.Year, CriterionValues.Val FROM CriterionValues INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_4.2') AS B ON ( A.Casino_fk = B.Casino_fk) AND ( A.Year = B.Year)) AS C INNER JOIN Casinos ON C.Casino_fk = Casinos.id GROUP BY Casinos.Name PIVOT C.Year; 

crw_OL_RevokedBans = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference IN ('OL_5.2.1', 'OL_6.2.1' ) GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

crw_OL_UnauthorisedPlayer_GameAccesses = 
TRANSFORM Sum(CriterionValues.Val) AS TotalVal SELECT Casinos.Name FROM (CriterionValues INNER JOIN Casinos ON CriterionValues.Casino_fk = Casinos.id) INNER JOIN Criteria ON CriterionValues.Criterion_fk = Criteria.id WHERE Criteria.Reference = 'OL_2.5' GROUP BY Casinos.Name PIVOT CriterionValues.Year; 

vew_Casino_Period_Criterion_Values = 
SELECT tbl_Casino_Period_Criterion_Values.*, tbl_Criteria.Abbreviation, tbl_Criteria.Comment FROM tbl_CrossView_Infos, tbl_Criteria INNER JOIN tbl_Casino_Period_Criterion_Values ON tbl_Criteria.id = tbl_Casino_Period_Criterion_Values.Criterion_fk; 

vew_Users = 
SELECT Users.id AS USER_ID, Users.Username AS USERNAME, Users.Name AS USER_NAME, Users.First_Name AS USER_FIRSTNAME, Users.Passwd AS USER_PASSWORD, Users.isAdmin AS USER_ADMIN, Users.isLocked AS USER_LOCKED, Users.PrefLanguage AS USER_LANG FROM Users; 

